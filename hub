--!strict
-- Rixhu Fit Copy - Vertical Layout UI with Minimize and Proper Player Detection
-- Place this script in StarterPlayerScripts or StarterGui

local Players = game:GetService("Players")
local TweenService = game:GetService("TweenService")

local player = Players.LocalPlayer
local playerGui = player:WaitForChild("PlayerGui")

-- SOUND ASSET AND BACKGROUND IMAGE (replace these)
local CLICK_SOUND_ID = "rbxassetid://9080070218"
local BACKGROUND_IMAGE_ID = "rbxassetid://81566764268635"

-- Main ScreenGui
local screenGui = Instance.new("ScreenGui")
screenGui.Name = "RixhuFitUI"
screenGui.ResetOnSpawn = false
screenGui.IgnoreGuiInset = true
screenGui.Parent = playerGui

-- Master container (Frame)
local mainFrame = Instance.new("ImageLabel")
mainFrame.Size = UDim2.new(0.3, 0, 0.95, 0)
mainFrame.Position = UDim2.new(0.01, 0, 0.025, 0)
mainFrame.Image = BACKGROUND_IMAGE_ID
mainFrame.ScaleType = Enum.ScaleType.Stretch
mainFrame.BackgroundTransparency = 1
mainFrame.Name = "MainUI"
mainFrame.Active = true
mainFrame.Draggable = true
mainFrame.Parent = screenGui

-- Corner
local uiCorner = Instance.new("UICorner")
uiCorner.CornerRadius = UDim.new(0, 16)
uiCorner.Parent = mainFrame

-- Title Label
local title = Instance.new("TextLabel")
title.Size = UDim2.new(1, 0, 0.08, 0)
title.Position = UDim2.new(0, 0, 0, 0)
title.BackgroundTransparency = 1
title.Text = "Rixhu Fit Copy"
title.TextColor3 = Color3.new(1, 1, 1)
title.Font = Enum.Font.GothamBold
title.TextScaled = true
title.Parent = mainFrame

-- Minimize button (top-right corner)
local minimizeBtn = Instance.new("TextButton")
minimizeBtn.Size = UDim2.new(0.2, 0, 0.08, 0)
minimizeBtn.Position = UDim2.new(0.8, 0, 0, 0)
minimizeBtn.BackgroundColor3 = Color3.new(0, 0, 0)
minimizeBtn.Text = "_"
minimizeBtn.TextColor3 = Color3.new(1, 1, 1)
minimizeBtn.Font = Enum.Font.GothamBold
minimizeBtn.TextScaled = true
minimizeBtn.Parent = mainFrame
local btnCorner = Instance.new("UICorner")
btnCorner.CornerRadius = UDim.new(0, 8)
btnCorner.Parent = minimizeBtn

-- Toggle visibility
local isMinimized = false
minimizeBtn.MouseButton1Click:Connect(function()
	isMinimized = not isMinimized
	for _, child in ipairs(mainFrame:GetChildren()) do
		if child ~= minimizeBtn then
			child.Visible = not isMinimized
		end
	end
end)

-- Player List Section
local playerListLabel = Instance.new("TextLabel")
playerListLabel.Size = UDim2.new(1, 0, 0.05, 0)
playerListLabel.Position = UDim2.new(0, 0, 0.1, 0)
playerListLabel.BackgroundTransparency = 1
playerListLabel.Text = "Players"
playerListLabel.TextColor3 = Color3.new(1, 1, 1)
playerListLabel.Font = Enum.Font.Gotham
playerListLabel.TextScaled = true
playerListLabel.Parent = mainFrame

local playerScroll = Instance.new("ScrollingFrame")
playerScroll.Size = UDim2.new(0.95, 0, 0.4, 0)
playerScroll.Position = UDim2.new(0.025, 0, 0.15, 0)
playerScroll.BackgroundColor3 = Color3.new(0, 0, 0)
playerScroll.ScrollBarThickness = 6
playerScroll.CanvasSize = UDim2.new(0, 0, 0, 0)
playerScroll.AutomaticCanvasSize = Enum.AutomaticSize.Y
playerScroll.Parent = mainFrame

local playerListLayout = Instance.new("UIListLayout")
playerListLayout.Padding = UDim.new(0, 4)
playerListLayout.SortOrder = Enum.SortOrder.LayoutOrder
playerListLayout.Parent = playerScroll

local selectedPlayer = nil

-- Utility: Create button
local function createButton(text)
	local btn = Instance.new("TextButton")
	btn.Size = UDim2.new(1, -10, 0, 40)
	btn.Text = text
	btn.BackgroundColor3 = Color3.new(0, 0, 0)
	btn.TextColor3 = Color3.new(1, 1, 1)
	btn.Font = Enum.Font.Gotham
	btn.TextScaled = true
	btn.AutoButtonColor = false
	local sound = Instance.new("Sound")
	sound.SoundId = CLICK_SOUND_ID
	sound.Volume = 1
	sound.Parent = btn
	btn.MouseButton1Click:Connect(function()
		sound:Play()
		TweenService:Create(btn, TweenInfo.new(0.15), {
			Size = btn.Size + UDim2.new(0, 4, 0, 4)
		}):Play()
		task.wait(0.15)
		TweenService:Create(btn, TweenInfo.new(0.15), {
			Size = UDim2.new(1, -10, 0, 40)
		}):Play()
	end)
	local corner = Instance.new("UICorner")
	corner.CornerRadius = UDim.new(0, 10)
	corner.Parent = btn
	return btn
end

-- Detect & display players
local function refreshPlayerList()
	playerScroll:ClearAllChildren()
	playerListLayout.Parent = playerScroll
	for _, plr in ipairs(Players:GetPlayers()) do
		if plr ~= player then
			local btn = createButton(plr.DisplayName)
			btn.Parent = playerScroll
			btn.MouseButton1Click:Connect(function()
				selectedPlayer = plr
				for _, other in ipairs(playerScroll:GetChildren()) do
					if other:IsA("TextButton") then
						other.BackgroundColor3 = Color3.new(0, 0, 0)
					end
				end
				btn.BackgroundColor3 = Color3.fromRGB(255, 0, 0)
				-- TODO: Populate accessories section here
			end)
		end
	end
end

Players.PlayerAdded:Connect(refreshPlayerList)
Players.PlayerRemoving:Connect(refreshPlayerList)
refreshPlayerList()
